const q=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const v of s.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&c(v)}).observe(document,{childList:!0,subtree:!0});function l(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(o){if(o.ep)return;o.ep=!0;const s=l(o);fetch(o.href,s)}};q();const y={up:{x:0,y:-1},down:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}};function p(e,t){return!(e.x===t.x&&e.y===t.y||e.x===-t.x&&e.y===t.y||e.x===t.x&&e.y===-t.y)}function b(e,t,l){return e<0?t:e>1?l:e*(l-t)+t}const C=document.querySelector("#score"),d=document.querySelector("#game"),w=Math.min(innerWidth,innerHeight);d.width=w;d.height=w;const i=d.getContext("2d"),h=20,n=w/h;let S=0;I(0);const g=[];L();let u={x:1,y:0},f;const r={next:void 0,previous:void 0,x:5+u.x,y:5+u.y,cx:5,cy:5,sx:5,sy:5};let a=r;for(let e=0;e<5;e+=1)k({x:-1,y:0});addEventListener("keydown",({code:e})=>{switch(e){case"KeyW":case"ArrowUp":p(u,y.up)&&(f=y.up);break;case"KeyS":case"ArrowDown":p(u,y.down)&&(f=y.down);break;case"KeyA":case"ArrowLeft":p(u,y.left)&&(f=y.left);break;case"KeyD":case"ArrowRight":p(u,y.right)&&(f=y.right);break}});let P=0;const m=100;let x=0,A=!1;requestAnimationFrame(M);function M(e){if(A)return;const t=e-P;P=e,x+=t,x>m&&(x-=m,F()),(O()||D())&&(A=!0),E(),K(),N(),requestAnimationFrame(M)}function K(){let e=r;for(;e.cx=b(x/m,e.sx,e.x),e.cy=b(x/m,e.sy,e.y),!!e.next;)e=e.next}function O(){let e=r.next;for(;;){if(e.x===r.x&&e.y===r.y)return!0;if(!e.next)break;e=e.next}return!1}function D(){return r.x<0||r.y<0||r.x>=h||r.y>=h}function E(){const e=g.findIndex(t=>t.x===r.sx&&t.y===r.sy);e!==-1&&(g.splice(e,1),L(),k(),I())}function F(){f&&(u=f,f=void 0);let e=a;for(;e.previous;){const c=e.x,o=e.y;e.x=e.previous.x,e.y=e.previous.y,e.sx=c,e.sy=o,e=e.previous}const t=r.x,l=r.y;r.x+=u.x,r.y+=u.y,r.sx=t,r.sy=l}function N(){i.clearRect(0,0,d.width,d.height);for(let l=0;l<100;l+=1)for(let c=0;c<100;c+=1)i.fillStyle=(c+l)%2==0?"lightgreen":"green",i.fillRect(c*n,l*n,n,n);for(const l of g){i.fillStyle="red";const c=n*4/7;i.beginPath(),i.arc(l.x*n+n/2,l.y*n+n/2,c,0,Math.PI*2),i.closePath(),i.fill()}let e=a;for(;e.previous;){i.fillStyle="pink";const l=n*4/7;i.beginPath(),i.arc(e.cx*n+n/2,e.cy*n+n/2,l,0,Math.PI*2),i.closePath(),i.fill(),e=e.previous}i.fillStyle="magenta";const t=n*5/7;i.beginPath(),i.arc(r.cx*n+n/2,r.cy*n+n/2,t,0,Math.PI*2),i.closePath(),i.fill()}function k(e={x:0,y:0}){const t={x:a.x+e.x,y:a.y+e.y,cx:a.x+e.x,cy:a.y+e.y,sx:a.x+e.x,sy:a.y+e.y};a.next=t,t.previous=a,a=t}function L(){const e=Math.floor(Math.random()*h),t=Math.floor(Math.random()*h);g.push({x:e,y:t})}function I(e=1){S+=e,C.textContent=S.toString().padStart(3,"0")}
